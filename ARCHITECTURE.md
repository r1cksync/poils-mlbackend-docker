# System Architecture - Hindi OCR System

## ğŸ—ï¸ Overall Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        USER / CLIENT                             â”‚
â”‚                  (Next.js Frontend - Port 3000)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ HTTP/HTTPS
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Next.js Backend (Port 3001)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  API Routes:                                              â”‚  â”‚
â”‚  â”‚  â€¢ /api/auth/*          - Authentication (JWT)           â”‚  â”‚
â”‚  â”‚  â€¢ /api/chats/*         - Chat management                â”‚  â”‚
â”‚  â”‚  â€¢ /api/documents/*     - Document handling              â”‚  â”‚
â”‚  â”‚  â€¢ /api/documents/ocr   - OCR processing trigger         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  MongoDB     â”‚  â”‚  AWS S3      â”‚  â”‚  Python Backend API  â”‚ â”‚
â”‚  â”‚  (Data)      â”‚  â”‚  (Files)     â”‚  â”‚  (OCR Processing)    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                â”‚
                                                â”‚ HTTP POST
                                                â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚   Python FastAPI Backend (Port 8000)         â”‚
                        â”‚   Dockerized - Deployed on Render            â”‚
                        â”‚                                              â”‚
                        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                        â”‚  â”‚  FastAPI Application                    â”‚ â”‚
                        â”‚  â”‚  â€¢ CORS middleware                      â”‚ â”‚
                        â”‚  â”‚  â€¢ Request validation (Pydantic)        â”‚ â”‚
                        â”‚  â”‚  â€¢ Error handling                       â”‚ â”‚
                        â”‚  â”‚  â€¢ Logging                              â”‚ â”‚
                        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                        â”‚                                              â”‚
                        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                        â”‚  â”‚  Image Processor Service                â”‚ â”‚
                        â”‚  â”‚  â€¢ Format conversion                    â”‚ â”‚
                        â”‚  â”‚  â€¢ Validation                           â”‚ â”‚
                        â”‚  â”‚  â€¢ Preprocessing (grayscale, denoise)   â”‚ â”‚
                        â”‚  â”‚  â€¢ Resizing                             â”‚ â”‚
                        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                        â”‚                                              â”‚
                        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                        â”‚  â”‚  Model Service                          â”‚ â”‚
                        â”‚  â”‚  â€¢ Indic-TrOCR Model                    â”‚ â”‚
                        â”‚  â”‚  â€¢ PyTorch Inference                    â”‚ â”‚
                        â”‚  â”‚  â€¢ Transformers Pipeline                â”‚ â”‚
                        â”‚  â”‚  â€¢ Text extraction                      â”‚ â”‚
                        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                        â”‚                                              â”‚
                        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                        â”‚  â”‚  Model Cache (Persistent Disk)          â”‚ â”‚
                        â”‚  â”‚  â€¢ Pre-trained weights (~1GB)           â”‚ â”‚
                        â”‚  â”‚  â€¢ Tokenizer configs                    â”‚ â”‚
                        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Request Flow - Document Upload & OCR

```
1. USER UPLOADS DOCUMENT
   â”‚
   â”œâ”€â–º Frontend (Next.js)
   â”‚   â””â”€â–º File validation (size, type)
   â”‚
2. SEND TO NEXT.JS BACKEND
   â”‚
   â”œâ”€â–º POST /api/documents/ocr
   â”‚   â”œâ”€â–º Verify JWT token
   â”‚   â”œâ”€â–º Extract user ID
   â”‚   â””â”€â–º Receive file
   â”‚
3. STORE IN AWS S3
   â”‚
   â”œâ”€â–º Generate unique S3 key
   â”œâ”€â–º Upload to S3 bucket
   â””â”€â–º Get S3 URL
   â”‚
4. CREATE DOCUMENT RECORD
   â”‚
   â”œâ”€â–º MongoDB.Document.create()
   â”‚   â”œâ”€â–º userId
   â”‚   â”œâ”€â–º fileName
   â”‚   â”œâ”€â–º s3Key
   â”‚   â””â”€â–º status: "processing"
   â”‚
5. SEND TO PYTHON BACKEND
   â”‚
   â”œâ”€â–º POST {PYTHON_BACKEND_URL}/api/ocr/extract
   â”‚   â””â”€â–º FormData with image file
   â”‚
6. PYTHON BACKEND PROCESSING
   â”‚
   â”œâ”€â–º Validate image
   â”‚
   â”œâ”€â–º Preprocess image
   â”‚   â”œâ”€â–º Convert to grayscale
   â”‚   â”œâ”€â–º Apply thresholding
   â”‚   â”œâ”€â–º Denoise
   â”‚   â””â”€â–º Resize if needed
   â”‚
   â”œâ”€â–º Load TrOCR Model (if not loaded)
   â”‚   â”œâ”€â–º Vision Encoder (DeiT)
   â”‚   â””â”€â–º Text Decoder (RoBERTa Hindi)
   â”‚
   â”œâ”€â–º Run Inference
   â”‚   â”œâ”€â–º Extract pixel values
   â”‚   â”œâ”€â–º Generate text tokens
   â”‚   â””â”€â–º Decode to Hindi text
   â”‚
   â””â”€â–º Return results
       â”œâ”€â–º text (extracted Hindi)
       â”œâ”€â–º confidence (0-1)
       â””â”€â–º processing_time (seconds)
   â”‚
7. UPDATE DOCUMENT IN MONGODB
   â”‚
   â”œâ”€â–º Document.findByIdAndUpdate()
   â”‚   â”œâ”€â–º ocrText: extracted text
   â”‚   â”œâ”€â–º ocrConfidence: confidence score
   â”‚   â””â”€â–º status: "completed"
   â”‚
8. RETURN TO FRONTEND
   â”‚
   â””â”€â–º Response JSON
       â”œâ”€â–º success: true
       â”œâ”€â–º text: "à¤¨à¤¿à¤•à¤¾à¤²à¤¾ à¤—à¤¯à¤¾ à¤ªà¤¾à¤ "
       â””â”€â–º documentId
```

## ğŸ“Š Data Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Browser    â”‚
â”‚  (User)      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 1. Upload Document
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Next.js         â”‚
â”‚  Frontend        â”‚
â”‚  (Port 3000)     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 2. POST /api/documents/ocr
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      3. Store File      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Next.js         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   AWS S3     â”‚
â”‚  Backend         â”‚                           â”‚  Bucket      â”‚
â”‚  (Port 3001)     â”‚                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 4. Save metadata
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    MongoDB       â”‚
â”‚   (Atlas)        â”‚
â”‚  - userId        â”‚
â”‚  - fileName      â”‚
â”‚  - s3Key         â”‚
â”‚  - status        â”‚
â”‚  - ocrText       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 5. Send for OCR
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Python FastAPI        â”‚
â”‚  (Port 8000 / Render)  â”‚
â”‚                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Image Processor  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚           â”‚            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ TrOCR Model      â”‚  â”‚
â”‚  â”‚ (Indic-TrOCR)    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚           â”‚            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Text Output      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”‚ 6. Return OCR result
            â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚   Response   â”‚
       â”‚  {           â”‚
       â”‚   text: "...",â”‚
       â”‚   confidence  â”‚
       â”‚  }           â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” Authentication Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚
     â”‚ 1. POST /api/auth/signup
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Next.js API   â”‚
â”‚                 â”‚
â”‚  â€¢ Hash pwd     â”‚
â”‚  â€¢ Create user  â”‚
â”‚  â€¢ Generate JWT â”‚
â”‚  â€¢ Set cookie   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ 2. JWT Token
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   MongoDB       â”‚
â”‚   User stored   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ 3. Redirect to dashboard
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Protected     â”‚
â”‚   Routes        â”‚
â”‚   (Middleware)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ³ Docker Container Structure

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Docker Container (Python Backend)          â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Python 3.9 Slim                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  System Dependencies               â”‚    â”‚
â”‚  â”‚  â€¢ libgl1-mesa-glx (OpenCV)       â”‚    â”‚
â”‚  â”‚  â€¢ poppler-utils (PDF)             â”‚    â”‚
â”‚  â”‚  â€¢ libglib2.0-0                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Python Packages                   â”‚    â”‚
â”‚  â”‚  â€¢ fastapi                         â”‚    â”‚
â”‚  â”‚  â€¢ uvicorn                         â”‚    â”‚
â”‚  â”‚  â€¢ torch                           â”‚    â”‚
â”‚  â”‚  â€¢ transformers                    â”‚    â”‚
â”‚  â”‚  â€¢ Pillow, OpenCV                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Application Code                  â”‚    â”‚
â”‚  â”‚  /app/main.py                      â”‚    â”‚
â”‚  â”‚  /app/app/*                        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Persistent Volume                 â”‚    â”‚
â”‚  â”‚  /app/model_cache                  â”‚    â”‚
â”‚  â”‚  (Model weights stored here)       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                             â”‚
â”‚  EXPOSE: 8000                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸŒ Deployment Architecture (Render)

```
Internet
    â”‚
    â”‚ HTTPS
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Render Load Balancer              â”‚
â”‚   â€¢ SSL/TLS termination             â”‚
â”‚   â€¢ Health checks                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Docker Container                  â”‚
â”‚   â€¢ Auto-scaling                    â”‚
â”‚   â€¢ Auto-restart                    â”‚
â”‚   â€¢ Log aggregation                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Persistent Disk (5GB)             â”‚
â”‚   â€¢ Model cache                     â”‚
â”‚   â€¢ Survives restarts               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¦ Technology Stack

```
Frontend Layer
â”œâ”€â–º Next.js 14 (App Router)
â”œâ”€â–º React 18
â”œâ”€â–º TypeScript
â”œâ”€â–º Tailwind CSS
â””â”€â–º Axios

Next.js Backend Layer
â”œâ”€â–º Next.js API Routes
â”œâ”€â–º MongoDB (Mongoose)
â”œâ”€â–º JWT Authentication
â”œâ”€â–º AWS S3 (AWS SDK v3)
â””â”€â–º bcryptjs

Python Backend Layer
â”œâ”€â–º FastAPI
â”œâ”€â–º PyTorch
â”œâ”€â–º Transformers (Hugging Face)
â”œâ”€â–º Indic-TrOCR Model
â”œâ”€â–º OpenCV
â”œâ”€â–º Pillow
â””â”€â–º Pydantic

Infrastructure
â”œâ”€â–º Docker
â”œâ”€â–º Render (Python backend)
â”œâ”€â–º Vercel (Next.js - optional)
â”œâ”€â–º MongoDB Atlas
â””â”€â–º AWS S3
```

## ğŸ”„ Model Loading & Caching

```
First Request:
    â”‚
    â”œâ”€â–º Model not in cache
    â”‚
    â”œâ”€â–º Download from Hugging Face
    â”‚   â”œâ”€â–º Vision encoder (~500MB)
    â”‚   â”œâ”€â–º Text decoder (~500MB)
    â”‚   â””â”€â–º Tokenizer configs
    â”‚
    â”œâ”€â–º Save to persistent disk
    â”‚   â””â”€â–º /app/model_cache/
    â”‚
    â”œâ”€â–º Load into memory
    â”‚
    â””â”€â–º Ready for inference

Subsequent Requests:
    â”‚
    â”œâ”€â–º Model in cache âœ“
    â”‚
    â”œâ”€â–º Load from disk (fast)
    â”‚
    â””â”€â–º Ready for inference
```

## ğŸ¯ Scalability Considerations

### Horizontal Scaling (Multiple Instances)
```
Load Balancer
    â”‚
    â”œâ”€â–º Instance 1 (Model loaded)
    â”œâ”€â–º Instance 2 (Model loaded)
    â””â”€â–º Instance 3 (Model loaded)
```

### Vertical Scaling (Bigger Instance)
```
CPU â†’ GPU
2GB RAM â†’ 8GB RAM
1 vCPU â†’ 4 vCPU
```

### Async Processing (Future Enhancement)
```
User Request
    â”‚
    â”œâ”€â–º Queue (Redis/Celery)
    â”‚
    â”œâ”€â–º Background Worker
    â”‚   â””â”€â–º Process OCR
    â”‚
    â””â”€â–º Webhook callback
```

---

This architecture provides:
- âœ… Separation of concerns
- âœ… Scalability
- âœ… Maintainability
- âœ… Security (JWT auth)
- âœ… Performance (model caching)
- âœ… Reliability (health checks, error handling)
